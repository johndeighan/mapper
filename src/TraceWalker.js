// Generated by CoffeeScript 2.7.0
  // TraceWalker.coffee
import {
  assert,
  undef,
  defined,
  OL
} from '@jdeighan/coffee-utils';

import {
  arrayToBlock
} from '@jdeighan/coffee-utils/block';

import {
  TreeWalker
} from '@jdeighan/mapper/tree';

// ---------------------------------------------------------------------------
export var TraceWalker = class TraceWalker extends TreeWalker {
  // ..........................................................
  //     builds a trace of the tree
  //        which is returned by endWalk()
  beginWalk() {
    this.lTrace = ["BEGIN WALK"]; // an array of strings
  }

  // ..........................................................
  visit(hLine, hUser, lStack) {
    var level, type, uobj;
    ({uobj, level, type} = hLine);
    if (defined(type)) {
      this.lTrace.push(`VISIT     ${level} ${OL(uobj)} (${type})`);
    } else {
      this.lTrace.push(`VISIT     ${level} ${OL(uobj)}`);
    }
  }

  // ..........................................................
  endVisit(hLine, hUser, lStack) {
    var level, type, uobj;
    ({uobj, level, type} = hLine);
    if (defined(type)) {
      this.lTrace.push(`END VISIT ${level} ${OL(uobj)} (${type})`);
    } else {
      this.lTrace.push(`END VISIT ${level} ${OL(uobj)}`);
    }
  }

  // ..........................................................
  endWalk() {
    var block;
    this.lTrace.push("END WALK");
    block = arrayToBlock(this.lTrace);
    this.lTrace = undef;
    return block;
  }

};

// ---------------------------------------------------------------------------
